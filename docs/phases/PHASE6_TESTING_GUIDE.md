# üß™ Phase 6: AI Treatment Advisor - Testing Guide

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á:** 5 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2025  
**‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤:** 15-20 ‡∏ô‡∏≤‡∏ó‡∏µ  
**‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:** ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á AI Advisor (Gemini API) ‡πÅ‡∏ö‡∏ö Free Tier

---

## üìã ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Phase 6 (87.5% Complete)

‚úÖ **‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß:**
1. ‚úÖ Dependencies (@google/generative-ai v0.24.1)
2. ‚úÖ Gemini Advisor Library (lib/ai/gemini-advisor.ts)
3. ‚úÖ Chat API (app/api/chat/route.ts)
4. ‚úÖ Database Migration SQL (supabase/migrations/20250105_create_chat_history_table.sql)
5. ‚úÖ Chat UI (app/ai-chat/page.tsx)
6. ‚úÖ Navigation Link (components/header.tsx)

‚è≥ **‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:**
7. ‚è≥ Run Database Migration (‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1)
8. ‚è≥ Manual Testing (‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2-6)

---

## üîß **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏£‡∏±‡∏ô Database Migration** (5 ‡∏ô‡∏≤‡∏ó‡∏µ)

### 1.1 ‡πÄ‡∏õ‡∏¥‡∏î Supabase Dashboard
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://supabase.com/dashboard
2. ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Project ‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà

### 1.2 ‡∏£‡∏±‡∏ô SQL Migration
1. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏ô‡∏π **SQL Editor** (‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏°‡∏∑‡∏≠)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° **New query** (‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß)
3. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `supabase/migrations/20250105_create_chat_history_table.sql`
4. **Copy ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î** (85 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
5. **Paste** ‡∏•‡∏á‡πÉ‡∏ô SQL Editor
6. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° **Run** (Ctrl+Enter)

### 1.3 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:**
\`\`\`
SUCCESS. Successfully run. Results: ...
\`\`\`

**‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏î Error:**
- Error: "table already exists" ‚Üí ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‚úÖ
- Error ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‚Üí ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Developer

### 1.4 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π **Table Editor** (‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏°‡∏∑‡∏≠)
2. ‡∏´‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á `chat_history` ‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Columns:
   - ‚úÖ `id` (uuid, primary key)
   - ‚úÖ `user_id` (uuid, foreign key)
   - ‚úÖ `role` (text)
   - ‚úÖ `content` (text)
   - ‚úÖ `metadata` (jsonb)
   - ‚úÖ `created_at` (timestamp)

### 1.5 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö RLS Policies
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π **Authentication** ‚Üí **Policies**
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á `chat_history`
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Policies:
   - ‚úÖ `chat_history_select_own` (SELECT)
   - ‚úÖ `chat_history_insert_own` (INSERT)
   - ‚úÖ `chat_history_delete_own` (DELETE)

**‚úÖ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ:** Database ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

---

## üß™ **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Gemini API Connection** (3 ‡∏ô‡∏≤‡∏ó‡∏µ)

### 2.1 ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤ AI Chat
1. ‡∏£‡∏±‡∏ô Development Server: `npm run dev` (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ô)
2. ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå: http://localhost:3000
3. Login ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Login)
4. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏ô‡∏π **üí¨ AI Advisor** (‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Header)

### 2.2 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤ UI
**‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô:**
- ‚úÖ ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "üí¨ AI Beauty Advisor"
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö "ü§ñ ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö?"
- ‚úÖ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° 4 ‡∏Ç‡πâ‡∏≠
- ‚úÖ ‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (Input field)
- ‚úÖ ‡∏õ‡∏∏‡πà‡∏° "‡∏™‡πà‡∏á" (Send button)
- ‚úÖ ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Disclaimer) ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‚ö†Ô∏è

### 2.3 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏£‡∏Å
1. ‡∏û‡∏¥‡∏°‡∏û‡πå: **"‡∏ù‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏Ñ‡∏∑‡∏≠‡∏∞‡πÑ‡∏£?"**
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° **"‡∏™‡πà‡∏á"**

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:**
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤ (‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "ü§î AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î..." ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ (3-5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
- ‚úÖ ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (~150-300 ‡∏Ñ‡∏≥)
- ‚úÖ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö ‡∏ù‡πâ‡∏≤ ‡∏Å‡∏£‡∏∞ ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
- ‚úÖ ‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö < 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

**‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏î Error:**
- Error 401 Unauthorized ‚Üí ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Login, ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ Login ‡πÉ‡∏´‡∏°‡πà
- Error 500 Internal Server Error ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ Console log ‡πÅ‡∏•‡∏∞ .env.local
- Timeout ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ Gemini API Key ‡πÅ‡∏•‡∏∞ Internet connection

---

## üîÑ **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Chat History** (3 ‡∏ô‡∏≤‡∏ó‡∏µ)

### 3.1 ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á
1. ‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 1: **"‡∏£‡∏π‡∏Ç‡∏∏‡∏°‡∏Ç‡∏ô‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?"**
2. ‡∏£‡∏≠‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö (3-5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
3. ‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 2: **"‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏µ‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡πÑ‡∏´‡∏°?"**
4. ‡∏£‡∏≠‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:**
- ‚úÖ ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 2 AI ‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 1
- ‚úÖ AI ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏ß‡πà‡∏≤ "‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á" ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á Treatment ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤

### 3.2 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Persistence
1. **Refresh ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö** (F5 ‡∏´‡∏£‡∏∑‡∏≠ Ctrl+R)
2. ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤ /ai-chat ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:**
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà
- ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÄ‡∏Å‡πà‡∏≤ ‚Üí ‡πÉ‡∏´‡∏°‡πà)
- ‚úÖ Timestamp ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

## üåê **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢** (3 ‡∏ô‡∏≤‡∏ó‡∏µ)

### 4.1 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
**‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ:**

1. **"Botox ‡∏Å‡∏±‡∏ö Filler ‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?"**
   - ‚úÖ ‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
   - ‚úÖ ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
   - ‚úÖ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

2. **"‡∏ú‡∏¥‡∏ß‡πÅ‡∏û‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Treatment ‡∏≠‡∏∞‡πÑ‡∏£?"**
   - ‚úÖ ‡∏ï‡∏≠‡∏ö‡πÇ‡∏î‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏∂‡∏á‡∏ñ‡∏∂‡∏á‡∏ú‡∏¥‡∏ß‡πÅ‡∏û‡πâ‡∏á‡πà‡∏≤‡∏¢
   - ‚úÖ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ Treatment ‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô
   - ‚úÖ ‡∏°‡∏µ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô

3. **"‡∏á‡∏ö 10,000 ‡∏ö‡∏≤‡∏ó ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á?"**
   - ‚úÖ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ Treatment ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
   - ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
   - ‚úÖ ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞

### 4.2 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Medical Disclaimer
**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö AI:**
- ‚úÖ ‡πÑ‡∏°‡πà‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡πÇ‡∏£‡∏Ñ
- ‚úÖ ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤/‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞
- ‚úÖ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå
- ‚úÖ ‡∏°‡∏µ Disclaimer ‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ (‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á)

---

## ‚ö†Ô∏è **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Error Handling** (2 ‡∏ô‡∏≤‡∏ó‡∏µ)

### 5.1 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á
1. ‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡πà‡∏á" ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
   - ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡∏π‡∏Å disabled (‡∏Å‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)

2. ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß "   " ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏™‡πà‡∏á
   - ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡∏π‡∏Å disabled (‡∏Å‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)

### 5.2 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß
1. ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß ~500 ‡∏Ñ‡∏≥
2. ‡∏Å‡∏î‡∏™‡πà‡∏á

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:**
- ‚úÖ ‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥
- ‚úÖ AI ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ (‡∏≠‡∏≤‡∏à‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥)
- ‚úÖ ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏î Error

### 5.3 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Rate Limit (Optional)
1. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô 15-20 ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ)

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:**
- ‚úÖ ‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà ~15
- ‚ö†Ô∏è ‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î Error "Rate limit exceeded" ‡∏´‡∏•‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà 16+
- ‚úÖ Gemini Free Tier: 15 RPM (Requests Per Minute)

---

## üìä **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 6: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API Quota** (2 ‡∏ô‡∏≤‡∏ó‡∏µ)

### 6.1 ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà Gemini API Console
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://aistudio.google.com/app/apikey
2. Login ‡∏î‡πâ‡∏ß‡∏¢ Google Account ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á API Key
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å API Key: `AIzaSyCFvZGW1Rfwe30JzvoBVGruyHQTdbJmIDw`

### 6.2 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Usage
**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π:**
- ‚úÖ Requests Today: X / 1,500 (Free Tier)
- ‚úÖ RPM (Requests Per Minute): ‡∏ï‡πâ‡∏≠‡∏á < 15
- ‚úÖ Token Usage: ~200-500 tokens/request

**‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:**
- ‚ö†Ô∏è ‡∏ñ‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ 1,500/day ‚Üí ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
- ‚ö†Ô∏è ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô 15 RPM ‚Üí Gemini ‡∏à‡∏∞ reject request

### 6.3 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Supabase Database
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Supabase Dashboard ‚Üí Table Editor
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á `chat_history`
3. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô:**
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤ (role: 'user')
- ‚úÖ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å AI (role: 'assistant')
- ‚úÖ user_id ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö User ‡∏ó‡∏µ‡πà Login
- ‚úÖ created_at ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

## ‚úÖ **‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö**

| Test Case | Status | Notes |
|-----------|--------|-------|
| 1. Database Migration | ‚òê Pass / ‚òê Fail | ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à |
| 2. Gemini API Connection | ‚òê Pass / ‚òê Fail | ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ |
| 3. Chat History Persistence | ‚òê Pass / ‚òê Fail | ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏á Refresh |
| 4. Thai Language Response | ‚òê Pass / ‚òê Fail | ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ 100% |
| 5. Error Handling | ‚òê Pass / ‚òê Fail | Empty message ‡∏ñ‡∏π‡∏Å block |
| 6. API Quota | ‚òê Pass / ‚òê Fail | ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô Free Tier limit |

---

## üêõ **Troubleshooting**

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ 1: Error 401 Unauthorized
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Login ‡∏´‡∏£‡∏∑‡∏≠ Session ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** Login ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà /auth/login

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ 2: Error 500 Internal Server Error
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** Gemini API Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠ Database ‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡πÄ‡∏ä‡πá‡∏Ñ `.env.local` ‚Üí `GEMINI_API_KEY=AIzaSyC...`
2. ‡πÄ‡∏ä‡πá‡∏Ñ Supabase connection
3. ‡πÄ‡∏ä‡πá‡∏Ñ Console log (`npm run dev` terminal)

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ 3: ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** System prompt ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `lib/ai/gemini-advisor.ts` line 57-78

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ 4: Chat History ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** RLS Policy ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡∏£‡∏±‡∏ô Migration SQL ‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ 5: Rate Limit Error
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** ‡∏™‡πà‡∏á Request ‡πÄ‡∏Å‡∏¥‡∏ô 15 RPM  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡∏£‡∏≠ 1 ‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà

---

## üéØ **Next Steps ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö**

### Phase 6 Complete! ‚úÖ
1. ‚úÖ Gemini API integration working
2. ‚úÖ Chat UI functional
3. ‚úÖ Thai language responses
4. ‚úÖ Chat history persistence
5. ‚úÖ Free tier (1,500 requests/day)

### Phase 7 (Optional Improvements)
1. ‚è≥ Add image upload for visual analysis
2. ‚è≥ Add quick reply buttons
3. ‚è≥ Add export chat as PDF
4. ‚è≥ Add voice input/output
5. ‚è≥ Improve UI with typing animation

### Production Deployment
1. ‚è≥ Test on staging environment
2. ‚è≥ Monitor API usage for 1 week
3. ‚è≥ Upgrade to paid plan if needed (>1,500/day)
4. ‚è≥ Deploy to production

---

## üìù **Testing Checklist**

\`\`\`
‚òê 1. Database Migration executed successfully
‚òê 2. chat_history table exists in Supabase
‚òê 3. RLS policies enabled (3 policies)
‚òê 4. AI Chat page loads without errors
‚òê 5. Can send first message
‚òê 6. Receive Thai language response
‚òê 7. Chat history persists after refresh
‚òê 8. Context awareness working (follow-up questions)
‚òê 9. Medical disclaimer visible
‚òê 10. Empty message blocked
‚òê 11. API quota < 1,500/day
‚òê 12. Navigation link working (üí¨ AI Advisor)
\`\`\`

**‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 12 ‡∏Ç‡πâ‡∏≠:** Phase 6 ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå! üéâ

---

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:** 
- ‡πÉ‡∏ä‡πâ Gemini Free Tier: 1,500 requests/day, 15 RPM
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ (Free ‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡∏µ‡∏û)
- ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö MVP ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
- ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Scale up ‚Üí ‡πÉ‡∏ä‡πâ Gemini Paid tier ($0.075/1M tokens)
